{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/gatsby-blog-github-pages/",
    "result": {"data":{"site":{"siteMetadata":{"title":"Blog"}},"markdownRemark":{"id":"829ca74b-163e-5541-96e6-f3447c2a809d","excerpt":"I didn’t find an article on the internet that covers the process thoroughly. So I want to share how I did this with my blog. This post covers how to set up…","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/86c83d771480abaadadf31990328cf0f/d5eae/preview.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 39.24050632911392%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABJ0AAASdAHeZh94AAABC0lEQVQoz3WRWXKDMAyGfZYuYTXG4AUwBMgy6UPvf52/I5mknSk8fJYta5e4Pr5h+hmNnxjtArQbN7nHCG0DbD8jrA/05xv8eGFcWCHo0H5CrhySssGpaHAqj0k2mVYGZdOhqD3y2rF/piwEVdVNV7jxAmUCqnaIRsqy0RHknFUGWWVfkF7kykA2PZduh4UDfeY13hKJ97Q64OAvkRCldlA2oJviLErtd4OR7q/+I1O7CKpImQF2WHmotQ08p1S2SGWU3NrWIr2pA3L+n1hCUAAbVp4h0XYzb5108b7ADAv/PXU060L7mJSTbFQGgpyH+Y7ufMO4fqG2I2/6ZcSVtkg2no5xCb9QB7TtH3T8+wE42wx4AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Gihub Action Build Job\"\n        title=\"Gihub Action Build Job\"\n        src=\"/blog/static/86c83d771480abaadadf31990328cf0f/f058b/preview.png\"\n        srcset=\"/blog/static/86c83d771480abaadadf31990328cf0f/c26ae/preview.png 158w,\n/blog/static/86c83d771480abaadadf31990328cf0f/6bdcf/preview.png 315w,\n/blog/static/86c83d771480abaadadf31990328cf0f/f058b/preview.png 630w,\n/blog/static/86c83d771480abaadadf31990328cf0f/40601/preview.png 945w,\n/blog/static/86c83d771480abaadadf31990328cf0f/78612/preview.png 1260w,\n/blog/static/86c83d771480abaadadf31990328cf0f/d5eae/preview.png 1407w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>I didn’t find an article on the internet that covers the process thoroughly. So I want to share how I did this with my blog.</p>\n<p>This post covers how to set up continuous deployment of Gatsby blog to Github Pages using Github Actions. It is applicable to any Gatsby project. I am going to use a blog as an example since it is probably the most common use of it. And let’s start right away.</p>\n<p>First, if you don’t have a project ready to publish, use <a href=\"https://github.com/gatsbyjs/gatsby-starter-blog\">Gatsby’s blog starter</a> as a template. You can follow instructions in its <code class=\"language-text\">README.md</code> file.</p>\n<p>Then, create directories <code class=\"language-text\">.github</code> in the root of the project and <code class=\"language-text\">workflows</code> inside. Inside of the <code class=\"language-text\">workflows</code> folder, create file <code class=\"language-text\">main.yml</code>. This structure will allow <em>Github Actions</em> to detect workflows automatically. Now your project structure should looks similar to this:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.\n├── .git\n├── .github\n│   └── workflows\n│       └── main.yml\n├── .gitignore\n├── .prettierignore\n├── .prettierrc\n├── LICENSE\n├── README.md\n├── content\n├── gatsby-browser.js\n├── gatsby-config.js\n├── gatsby-node.js\n├── package-lock.json\n├── package.json\n├── src\n├── node_modules\n└── static</code></pre></div>\n<p>The next step is to create a branch to serve as a source for <em>Github Pages</em>. You can choose any name, but <em>Github Pages</em> by default is looking <code class=\"language-text\">gh-pages</code> branch.</p>\n<p>Now we can fill our <code class=\"language-text\">main.yml</code> file. For this, we’ll be using Github Action called <a href=\"https://github.com/marketplace/actions/gatsby-publish\">Gatsby Publish</a> with several changes.</p>\n<p>Just copy and paste it into our <code class=\"language-text\">main.yml</code> file. Now <em>Github Actions</em> uses version 2, so change it to <code class=\"language-text\">uses: actions/checkout@v2</code>. Then, add <code class=\"language-text\">deploy-branch: gh-pages</code> in the end. This will tell the action what is the Github Pages source branch. Also, depending on the branch you are working in, change <code class=\"language-text\">dev</code> to it. It should be <code class=\"language-text\">master</code> if you used starter as a template.</p>\n<p>We need to set up an access token for <code class=\"language-text\">access-token: ${{ secrets.ACCESS_TOKEN }}</code> line. However, first, let’s finish with the project directory. For now, your <code class=\"language-text\">main.yml</code> file looks like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Gatsby Publish\n\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> master\n\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v2\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> enriikke/gatsby<span class=\"token punctuation\">-</span>gh<span class=\"token punctuation\">-</span>pages<span class=\"token punctuation\">-</span>action@v2\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">access-token</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.ACCESS_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">deploy-branch</span><span class=\"token punctuation\">:</span> gh<span class=\"token punctuation\">-</span>pages</code></pre></div>\n<p>If you are publishing your project to the root, meaning <em>username.github.io</em>, then you can skip everything related to path prefix.</p>\n<p>You need to tell <em>Gatsby</em> and <em>Github Pages</em> that links should be relative to your path. For this, add path prefix into <code class=\"language-text\">gatsby-config.js</code> so that it looks like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>\n  <span class=\"token literal-property property\">pathPrefix</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">/blog</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Replace <code class=\"language-text\">/blog</code> with the name of your project. You can read more about this <a href=\"https://www.gatsbyjs.com/docs/how-to/previews-deploys-hosting/path-prefix/\">here</a>.</p>\n<p>Then add the environmental variable <code class=\"language-text\">PREFIX_PATHS: true</code> into your yml file. So now it should look similar to this:</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Gatsby Publish\n\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> master\n\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">PREFIX_PATHS</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v2\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> enriikke/gatsby<span class=\"token punctuation\">-</span>gh<span class=\"token punctuation\">-</span>pages<span class=\"token punctuation\">-</span>action@v2\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">access-token</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.ACCESS_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">deploy-branch</span><span class=\"token punctuation\">:</span> gh<span class=\"token punctuation\">-</span>pages</code></pre></div>\n<p>Almost there. It is time to set up <em>access token</em>. In Github, go to Settings -> Developer settings -> Personal access tokens, and click on <em>Generate new token</em>. Give it access to <em><strong>repo</strong></em>, <em><strong>workflow</strong></em> and <em><strong>write:packages</strong></em> and set expiration time to <em><strong>No expiration</strong></em>. Click generate token and copy it.</p>\n<p>Now go to your project repository’s settings and find <em>Actions</em> under the <em>Secrets</em> section. Click on <em>New repository secret</em>. Name it <code class=\"language-text\">ACCESS_TOKEN</code> and paste generated token into the value field.</p>\n<p>Finally, you can push your project to Github, and <em>voila</em> everything works. You can see how the project is deployed in the <em>Actions</em> section in your repository.</p>","frontmatter":{"title":"Publish Gatsby project to GitHub Page using Github Actions","date":"February 26, 2022","description":"Set up your Gatsby project for automatic deployment to Github Pages using Github Actions."}},"previous":null,"next":null},"pageContext":{"id":"829ca74b-163e-5541-96e6-f3447c2a809d","previousPostId":null,"nextPostId":null}},
    "staticQueryHashes": ["2841359383","3257411868"]}